Dear MongoDB Support Team,

I hope this message finds you well. I am reaching out to seek clarification and guidance on a couple of aspects related to MongoDB Atlas and its operations, which are crucial for optimizing our database management and search functionalities.

Facet Queries on Sharded Collections: We are considering leveraging Atlas Search's facet queries over sharded collections to enhance our application's search capabilities. However, we noted in the documentation Atlas Search Facet Over Sharded Collections a requirement that the cluster must run MongoDB v6.0 or higher for such queries. Additionally, it mentions that on sharded Atlas clusters running MongoDB v7.2.0, $searchMeta might return an error for facet queries. Could you provide further insights into this limitation and any best practices or workarounds you recommend? Our goal is to implement efficient and reliable facet search functionality in our sharded environment.

Use of renameCollection() for Nightly Batch Loads: We are exploring the use of renameCollection() for swapping tables as part of our nightly batch load process. Our primary concern is the atomicity of this operation and whether there might be an intermediate state during the rename process where the collection is not accessible, potentially affecting our application's availability. Could you confirm if the renameCollection() operation is atomic and if there are any accessibility concerns we should be aware of? Additionally, any advice on best practices for using renameCollection() in such a scenario would be greatly appreciated.
